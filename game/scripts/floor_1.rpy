label floor_1:
    # 1층: 클라이맥스를 향해 고조되는 분위기
    $ renpy.music.play(bgm_floor_1_climax, fadein=1.0, loop=True)
    # 거대한 금속문.
    scene bg_1f_mental with dissolve
    
    n "EXIT... 드디어 여기까지 왔어."
    m "그래. 이제 끝이야. 저 문만 열면 돼. 우리가 함께 이 모든 것을 이겨낸 거야!"
    
    "나는 지금까지 무엇을 보아온 걸까. 나를 속박하던 존재, 나를 비추던 존재, 나에게 말을 걸던 존재들..."
    "그 모든 것들이 정말... 내 밖에 있었던 걸까?"
    "손이 문고리 위에서 멈칫했다. 손끝에서 느껴지는 차가운 금속의 감촉. 이것은 현실일까, 아니면 또 다른 함정일까?"
    
    n "무서워. 이 문 너머의 '일상'이, 방금까지 헤쳐온 '악몽'보다 더 낯설게 느껴져."
    m "두려워하지 마! 이 방이 우리를 지켜주는 곳이라니, 말도 안 돼. 우리가 함께 싸워 이겨낸 곳이야. 이 문을 열고 진짜 세상으로 나아가야 해. 빨리! 놈들이 눈치채기 전에!"
    n "나는... 무엇을 선택해야 하는가. 나의 직감을 믿어야 할까, 아니면... 저 문 너머의 공포를 외면해야 할까? 내 안에 있는 목소리는... 과연 나를 위한 목소리였을까?"
    
    menu:
        "이 문을 연다 (이것이 유일한 탈출구다)":
            "더는 생각하고 싶지 않아. 더 이상 감당할 수 없을 것 같아. 어떤 진실이든, 이 지옥보다는 나을 거야. 나는 모든 것을 끝내기로 결심했다."
            m "좋아. 드디어 우리가 해냈어! 문을 열고 나가자! 우리는... 자유를 얻은 거야!"
            jump ending_normal
        "되돌아본다 (...내가 본 건 진짜였을까?)":
            "아니. 도망치는 것은 의미가 없다. 나는 놈이 누구인지 알아야만 한다. 내가 본 모든 것들의 의미를. 이 악몽이 나에게 말하려 했던 진짜 진실을."
            n "내가 본 것, 내가 느낀 것. 그 모든 것의 의미를 알아야만 한다. 나는 더 이상 도망치지 않을 거야."
            m "무슨 소리야?! 미쳤어?! 빨리 나가야 해! 놈들이 눈치채기 전에! 이건 놈들의 마지막 함정일지도 몰라! 네가 이 문을 열지 않으면... 놈들이 널 부술 거야!"
            jump turn_back_1

label turn_back_1:
    # 획득한 진엔딩 플래그의 총 개수를 확인
    $ clue_count = 0
    if flag_clue_1:
        $ clue_count += 1
    if flag_clue_2:
        $ clue_count += 1
    if flag_clue_3:
        $ clue_count += 1
    if flag_clue_4:
        $ clue_count += 1
    if flag_clue_5:
        $ clue_count += 1

    if clue_count >= 5:
        jump memory_puzzle_minigame_1
    elif clue_count == 4:
        jump ending_partial_truth
    elif clue_count >= 2:
        jump ending_uncertain_realization
    elif clue_count == 1:
        jump ending_flickering_memory
    else:
        jump ending_normal

label memory_puzzle_minigame_1:
    n "모든 조각이 모였어. 이제... 이 끔찍한 기억을 내 손으로 완성해야만 해."
    m "안 돼! 제발 멈춰! 퍼즐을 맞추면 모든 것이 끝장나! 놈들이 원하는 게 그거야! 놈들은... 네 기억을 파괴할 거라고!"
    n "아니. 이게 마지막 기회야. 모든 것을 끝낼 마지막 기회. 진실을 마주할 마지막 기회."
    m "넌... 결국 나를 배신하는구나. 내가 그토록 놈들에게서 지켜냈는데... 네가 진실을 택한다면... 나는 사라져야만 해!"
    
    # 미니게임: 기억의 퍼즐 완성하기
    call screen minigame_puzzle

    if _return:
        "퍼즐이 맞춰졌다. 조각들이 하나가 되자, 온몸에 소름이 돋았다. 진실의 조각들이 맞춰지는 고통과 함께, 나는 모든 것을 기억해냈다."
        n "그래... 이게... 바로 진실이었어. 괴물은... 이 감옥은... 모두... 나였어."
        # 진엔딩, '???'의 왜곡된 목소리
        $ renpy.sound.play(sfx_voice_m_distorted, loop=False)
        m "아니야... 말도 안 돼... 이럴 리가 없어...! 놈들이... 놈들이 내 기억을 조작했어! 나는... 나는 너를 지키려 했을 뿐이라고! 제발... 나를 믿어줘! 나는... 나를 없애지 마...!"
        "내 안의 또 다른 목소리가 발악한다. 그것은 나의 기억이 아닌, 나의 두려움이었다. 나는 더 이상 그 목소리에 굴복하지 않았다. 나는 내 두려움의 실체를 마주했다."
        jump real_world_7
    else:
        "기억의 조각들이 손끝에서 흩어진다. 퍼즐이 완성되지 않았다. 나는 가장 중요한 순간에 실패하고 말았다."
        n "실패했어... 아직은 아닌가 봐... 나는... 모든 것을 기억해내지 못했어..."
        m "다행이야... 놈들의 마지막 함정을 피한 것 같아. 어서 문을 열고 나가자! 진실은... 아직 멀리 있어!"
        jump ending_partial_truth